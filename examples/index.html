<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bykugan Capture Demo</title>
    <style>
        body { font-family: system-ui, sans-serif; padding: 20px; text-align: center; }
        video { max-width: 100%; border: 1px solid #ccc; margin-top: 20px; }
        button { padding: 10px 20px; font-size: 16px; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Bykugan Screen Recorder</h1>
    <div>
        <button id="startBtn">Start Recording</button>
        <button id="stopBtn" disabled>Stop Recording</button>
        <button id="saveBtn" disabled>Download</button>
    </div>
    <video id="preview" autoplay muted playsinline></video>

    <script type="module">
        // Importing from the source for quick local testing without needing a full build/server setup if browser supports modules on files
        // But for better compatibility we might want to reference the dist. 
        // For now, let's try to import relative if served.
        import { BykuganRecorder } from '../src/index.js';

        const recorder = new BykuganRecorder();
        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        const saveBtn = document.getElementById('saveBtn');
        const preview = document.getElementById('preview');

        startBtn.onclick = async () => {
            try {
                const stream = await recorder.start();
                preview.srcObject = stream;
                startBtn.disabled = true;
                stopBtn.disabled = false;
                saveBtn.disabled = true;
            } catch (err) {
                alert('Failed to start recording: ' + err.message);
            }
        };

        stopBtn.onclick = async () => {
            const blob = await recorder.stop();
            preview.srcObject = null;
            preview.src = URL.createObjectURL(blob);
            preview.controls = true;
            startBtn.disabled = false;
            stopBtn.disabled = true;
            saveBtn.disabled = false;
        };

        saveBtn.onclick = () => {
            recorder.save('my-screen-recording.webm');
        };

        if (!BykuganRecorder.isSupported()) {
            document.body.innerHTML = '<h1>Screen recording not supported in this browser</h1>';
        }
    </script>
</body>
</html>
